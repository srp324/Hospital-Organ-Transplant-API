CREATE CONSTRAINT ON (h:Hospital) ASSERT h.name IS UNIQUE;
CREATE CONSTRAINT ON (o:Organ) ASSERT o.name IS UNIQUE;

USING PERIODIC COMMIT
LOAD CSV WITH HEADERS FROM "https://gist.githubusercontent.com/srp324/85c624f453abcaaa1ced553ab9ddb1f7/raw/fed5869345feceb459f155094c7fe7f92efdf35a/data.csv" AS line 
WITH line

MERGE (hospital: Hospital {name: UPPER(line.name)})
MERGE (organ: Organ {name: UPPER(line.organ)})

CREATE (hospital)-[t:TRANSPLANTS]->(organ)

SET t.type = line.type,
    t.volume = TOINT(line.volume),
    t.rate = TOFLOAT(line.rate)
;